#!/bin/csh -f
#-----------------------------------------------------------------------------
# $Id: Weekly.sun4sol,x 1.2 2006/07/31 01:52:48 cal103 Exp $
#-----------------------------------------------------------------------------

source ~/.login

echo "Running weekly update script for sun4sol machines"

# Build up misc documentation.

echo "Building miscellaneous documentation"
cd $MIR/guides/user
Buildchanges
Buildcheat
Buildtasks
cp changes.doc cheat.doc tasks.doc $MIR/doc
mv changes.doc cheat.doc tasks.doc $MIR/specdoc
Buildhtmltask
Buildmantask

# Update the documentation in anon ftp.

echo "Updating the anonymous ftp manuals"
cp $MIR/changes.txt $MIR/ftp/changes.txt
cp $MIR/README.html $MIR/ftp/install.html
cp $MIR/README.html $MIR/html
cp $MIR/DISCLAIMER  $MIR/ftp/disclaimer.txt
if ( -e $MIR/guides/user/userguide.ps.Z ) then
  cp $MIR/guides/user/userguide.ps.Z $MIR/ftp/userguide.ps.Z
  cp $MIR/guides/user/userguide.ps.Z /nfs/ftp/atnfdocs/guides/mirguide.ps.Z
endif
if ( -e $MIR/guides/user/userguide_US.ps.Z ) then
  cp $MIR/guides/user/userguide_US.ps.Z $MIR/ftp/userguide_US.ps.Z
  cp $MIR/guides/user/userguide_US.ps.Z /nfs/ftp/atnfdocs/guides/mirguide_US.ps.Z
endif
if ( -e $MIR/guides/user/userguide.ps.gz ) then
  cp $MIR/guides/user/userguide.ps.gz $MIR/ftp/userguide.ps.gz
  cp $MIR/guides/user/userguide.ps.gz /nfs/ftp/atnfdocs/guides/mirguide.ps.gz
endif
if ( -e $MIR/guides/user/userguide_US.ps.gz ) then
  cp $MIR/guides/user/userguide_US.ps.gz $MIR/ftp/userguide_US.ps.gz
  cp $MIR/guides/user/userguide_US.ps.gz /nfs/ftp/atnfdocs/guides/mirguide_US.ps.gz
endif
if ( -e $MIR/guides/prog/progguide.ps.Z ) then
  cp $MIR/guides/prog/progguide.ps.Z $MIR/ftp/progguide.ps.Z
endif
if ( -e $MIR/guides/prog/progguide.ps.gz ) then
  cp $MIR/guides/prog/progguide.ps.gz $MIR/ftp/progguide.ps.gz
endif

# Update the anon ftp distributions.

echo "Updating the anonymous ftp distribution of Miriad"
cd $MIR
find . -maxdepth 1 -name 'junk*' -exec rm -rf \{\} \;
mirtar junk.tar none
cp junk.tar $MIR/ftp/miriad.tar
cp junk.tar junk2.tar
gzip junk2.tar
mv junk2.tar.gz $MIR/ftp/miriad.tar.gz
compress junk.tar
mv junk.tar.Z $MIR/ftp/miriad.tar.Z
