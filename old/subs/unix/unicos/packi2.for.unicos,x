c************************************************************************
	subroutine packi2(in,out,n)
c
	implicit none
	integer n
	integer out(*),in(n)
c
c  Convert Cray integer array into FITS 16 bit integer array.
c
c------------------------------------------------------------------------
	integer i,k,n0,n1,i0,i1,i2,i3
	integer nshft(4),mask(4)
	data nshft/48,32,16,0/
	data mask/ 00 00007 77777 77777 77777b,
     *		   17 77770 00003 77777 77777b,
     *		   17 77777 77774 00001 77777b,
     *		   17 77777 77777 77776 00000b/
	save nshft,mask
c
c  Externals.
c
	integer shiftl
c
c  Do the first few, if they are not aligned on a word boundary.
c
	k = 0
c
c  Do the bulk of the data.
c
	n0 = (k+3)/4
	n1 = (n-k)/4 + n0
	n0 = n0 + 1
	do i=n0,n1
	  i0 = in(k+1).and.65535
	  i1 = in(k+2).and.65535
	  i2 = in(k+3).and.65535
	  i3 = in(k+4).and.65535
	  out(i) = shiftl(i0,48) .or. shiftl(i1,32) .or.
     *	            shiftl(i2,16) .or.        i3
	  k = k + 4
	enddo
c
c  Do the last few if there are any left over.
c
	do i=1,n-k
	  k = k + 1
	  out(n1+1) = (out(n1+1) .and. mask(i))  +
     *			shiftl(in(k).and.65535,nshft(i))
	enddo
c
	end
c************************************************************************
	subroutine unpacki2(in,out,n)
c
	implicit none
	integer n
	integer in(*),out(n)
c
c  Convert FITS 16 bit integer array into Cray integer array.
c
c------------------------------------------------------------------------
	integer i,k,n0,n1
	integer temp,in0
	integer nshft(4)
	data nshft/48,32,16,0/
c
c  Externals.
c
	integer shiftr
c
c  Do the first few ones, if we are not aligned on a word boundary.
c
	k = 0
c	if(offset.gt.0)then
c	  do i=offset+1,min(offset+n,4)
c	    k = k + 1
c	    temp = shiftr(in(1),nshft(i)) .and. 65535
c	    out(k) = temp - cvmgp(65536,0,temp-32768)
c	  enddo
c	endif
c
c  This loop should vectorise.
c
	n0 = (k+3)/4
	n1 = (n-k)/4 + n0
	n0 = n0 + 1
	do i=n0,n1
	  in0 = in(i)
c
	  temp = shiftr(in0,48) .and. 65535
	  out(k+1) = temp - cvmgp(65536,0,temp-32768)
c
	  temp = shiftr(in0,32) .and. 65535
	  out(k+2) = temp - cvmgp(65536,0,temp-32768)
c
	  temp = shiftr(in0,16) .and. 65535
	  out(k+3) = temp - cvmgp(65536,0,temp-32768)
c
	  temp =        in0     .and. 65535
	  out(k+4) = temp - cvmgp(65536,0,temp-32768)
	  k = k + 4
	enddo
c
c  Do the last few, if they are not word aligned.
c
	do i=1,n-k
	  k = k + 1
	  temp = shiftr(in(n1+1),nshft(i)) .and. 65535
	  out(k) = temp - cvmgp(65536,0,temp-32768)
	enddo
c
	end
